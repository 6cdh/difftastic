=====================================
Case with one branch
=====================================

update msg =
    case msg of
        Nothing ->
            Nothing

---

(file
  (value_declaration 
    (function_declaration_left (lower_case_identifier) (lower_pattern (lower_case_identifier)))
    (eq)
    (case_of_expr (case) (value_expr (value_qid (lower_case_identifier))) (of)
      (virtual_open_section)
        (case_of_branch 
            (pattern (union_pattern (upper_case_qid (upper_case_identifier)))) 
            (arrow)
            (value_expr (upper_case_qid (upper_case_identifier)))
        )
    )
  )
  (virtual_end_decl)
)



=====================================
Function statement with case
=====================================

update msg model =
    case msg of
        Increment ->
            model + 1

        Decrement ->
            model - 1

---

(file
  (value_declaration 
    (function_declaration_left (lower_case_identifier) (lower_pattern (lower_case_identifier)) (lower_pattern (lower_case_identifier)))
    (eq)
    (case_of_expr (case) (value_expr (value_qid (lower_case_identifier))) (of)
      (virtual_open_section)
        (case_of_branch (pattern (union_pattern (upper_case_qid (upper_case_identifier)))) (arrow)
                (bin_op_expr (value_expr (value_qid (lower_case_identifier))) (operator (operator_identifier)) (number_constant_expr (number_literal))))
        (virtual_end_decl)
        (case_of_branch (pattern (union_pattern (upper_case_qid (upper_case_identifier)))) (arrow)
                (bin_op_expr (value_expr (value_qid (lower_case_identifier))) (operator (operator_identifier)) (number_constant_expr (number_literal))))
    )
  )
  (virtual_end_decl)
)



=====================================
Function statement with case and follow up function
=====================================

src : Avatar -> Attribute msg
src (Avatar maybeUrl)=
    case maybeUrl of
        Nothing ->
            Asset.src Asset.defaultAvatar

        Just "" ->
            Asset.src Asset.defaultAvatar

        Just url ->
            Html.Attributes.src url


---

(file 
    (type_annotation 
        (lower_case_identifier)
        (colon)
        (type_expression 
            (type_ref (upper_case_qid (upper_case_identifier)))
            (arrow)
            (type_ref 
                (upper_case_qid (upper_case_identifier))
                (type_variable_ref (lower_case_identifier))
            )
        )
    )
    (virtual_end_decl)
    (value_declaration 
        (function_declaration_left 
            (lower_case_identifier)
            (left_parenthesis)
            (pattern 
                (union_pattern 
                    (upper_case_qid (upper_case_identifier))
                    (lower_pattern (lower_case_identifier))
                )
            )
            (right_parenthesis)
        )
        (eq)
        (case_of_expr 
            (case)
            (value_expr (value_qid (lower_case_identifier)))
            (of)
            (virtual_open_section)
            (case_of_branch 
                (pattern (union_pattern (upper_case_qid (upper_case_identifier))))
                (arrow)
                (function_call_expr 
                    (value_expr (value_qid (upper_case_identifier) (dot) (lower_case_identifier)))
                    (value_expr (value_qid (upper_case_identifier) (dot) (lower_case_identifier)))
                )
            )
            (virtual_end_decl)
            (case_of_branch 
                (pattern 
                    (union_pattern 
                        (upper_case_qid (upper_case_identifier))
                        (string_constant_expr (open_quote) (close_quote))
                    )
                )
                (arrow)
                (function_call_expr 
                    (value_expr (value_qid (upper_case_identifier) (dot) (lower_case_identifier)))
                    (value_expr (value_qid (upper_case_identifier) (dot) (lower_case_identifier)))
                )
            )
            (virtual_end_decl)
            (case_of_branch 
                (pattern 
                    (union_pattern 
                        (upper_case_qid (upper_case_identifier)) 
                        (lower_pattern (lower_case_identifier))
                    )
                )
                (arrow)
                (function_call_expr 
                    (value_expr 
                        (value_qid 
                            (upper_case_identifier) 
                            (dot) 
                            (upper_case_identifier) 
                            (dot) 
                            (lower_case_identifier)
                        )
                    )
                    (value_expr (value_qid (lower_case_identifier)))
                )
            )
        )
    )
    (virtual_end_decl)
)

